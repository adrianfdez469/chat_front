(this.webpackJsonpchat_front=this.webpackJsonpchat_front||[]).push([[12],{210:function(e,t,n){"use strict";var a,r=n(227),o=n.n(r),i=n(216),c={getSocket:function(){return a||(a=o()(i.a.server))},close:function(){a.close()}};t.a=c},211:function(e,t,n){"use strict";var a=n(226),r=n.n(a),o=n(3),i=n(212),c=n(216),s=n(6),l=n(22),u=n(217),d={errConn:{es:"Error de conexi\xf3n",en:"Network error"},getTokenIdError:{es:"Su sesi\xf3n ha expirado",en:"Expired session"}};t.a=function(){var e=Object(i.a)(),t=e.openErrorNotification,n=e.openSuccessNotification,a=Object(o.useRecoilValue)(s.j),p=Object(o.useRecoilValue)(s.f),m=Object(u.a)();return{postRequest:function(e){var o=e.url,i=e.bodyParams,s=void 0===i?{}:i,u=e.doFnAfterSuccess,f=void 0===u?null:u,b=e.doFnAfterError,g=void 0===b?null:b,E=e.messageOnSuccess,h=void 0===E?null:E,O=e.messageOnError,j=void 0===O?null:O,v=function(e){return r.a.post("".concat(c.a.server).concat(o),s,{headers:{Authorization:e}}).then((function(t){return h&&n(h),f&&f(t,e),t})).catch((function(e){return e.response?j&&t(j):t(d.errConn[a]),g&&g(e),e}))};if(p)return v(p).catch((function(e){return console.log("Error al realizar la peticion con el token guardado en recoil state, asi que intentamos usando firebase"),l.a.auth().currentUser.getIdToken(!0).then((function(e){return v(e)})).catch((function(e){return console.log("Error al realizar la peticion con el token proveniente de firebase"),m(),e}))}))}}}},212:function(e,t,n){"use strict";var a=n(9),r=n(20),o=n(3),i=n(72);t.a=function(){var e=Object(o.useRecoilState)(i.a),t=Object(r.a)(e,2),n=t[0],c=t[1],s=Object(a.a)(Object(a.a)({},n),{},{open:!0,autoHideDuration:3e3}),l=function(e,t){c(Object(a.a)(Object(a.a)({},s),{},{severity:e,msg:t}))};return{openNotification:function(e){c(Object(a.a)(Object(a.a)({},s),e))},openSuccessNotification:function(e){l("success",e)},openErrorNotification:function(e){l("error",e)},openInfoNotification:function(e){l("info",e)},openWarningNotification:function(e){l("warning",e)}}}},216:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={server:"https://shut-app-pro.herokuapp.com"}},217:function(e,t,n){"use strict";var a=n(3),r=n(6),o=n(0),i=n(210),c=n(22);t.a=function(){var e=Object(a.useSetRecoilState)(r.k),t=Object(a.useSetRecoilState)(r.m),n=Object(a.useSetRecoilState)(r.c),s=Object(a.useSetRecoilState)(r.h),l=i.a.getSocket(),u=Object(a.useSetRecoilState)(r.n.getAtom);return Object(o.useCallback)((function(){Object(r.e)(),t(null),n([]),s([]),l.emit("logout",{}),i.a.close(),e(null),c.a.auth().signOut(),u(r.n.posibleViews.LOGIN)}),[])}},230:function(e,t){},250:function(e){e.exports=JSON.parse('{"title":{"es":"Adicionar contacto","en":"Add contact"},"search":{"es":"Buscar...","en":"Search..."},"close":{"es":"Cerrar","en":"Close"},"lbErrorLoadingUsers":{"es":"Error al cargar los usuarios","en":"Error loading users"},"lbErrorSendigFriendRequest":{"es":"Error al enviar solicitud de amistad","en":"Error sending friend request"}}')},346:function(e){e.exports=JSON.parse('{"addContact":{"es":"Adicionar","en":"Add"},"addGroup":{"es":"Grupo","en":"Group"},"sendMsg":{"es":"Enviar","en":"Send"},"shareMsg":{"es":"Compartir","en":"Share"},"sendAll":{"es":"Difusi\xf3n","en":"Diffusion"}}')},427:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(20),i=n(3),c=n(198),s=n(430),l=n(431),u=n(409),d=n(298),p=n.n(d),m=n(299),f=n.n(m),b=Object(c.a)((function(e){return{speedDial:{position:"absolute",bottom:e.spacing(0),right:e.spacing(0)},speedDialDiv:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2),width:e.spacing(7),height:e.spacing(7)},icon:{color:e.palette.text.secondary}}})),g=r.a.memo((function(e){var t=e.idioma,n=e.handleOpen,a=e.handleClose,o=e.open,i=e.openAddContactView,c=e.text,d=b();return r.a.createElement("div",{id:"idMainButton",className:d.speedDialDiv},r.a.createElement(s.a,{ariaLabel:"Main speed dial button",className:d.speedDial,icon:r.a.createElement(l.a,null),onClose:a,onOpen:n,open:o},r.a.createElement(u.a,{key:"add",icon:r.a.createElement(p.a,{className:d.icon}),tooltipTitle:c.addContact[t],tooltipOpen:!0,onClick:i}),r.a.createElement(u.a,{key:"addgroup",icon:r.a.createElement(f.a,{className:d.icon}),tooltipTitle:c.sendAll[t],tooltipOpen:!0,onClick:function(){console.log("Enviar mensaje de difusion"),alert("Not implemented!")}})))})),E=n(21),h=n(417),O=n(415),j=n(418),v=n(419),S=n(412),R=n(414),k=n(416),C=n(411),N=n(300),y=n(209),A=n(433),I=n(303),w=n.n(I),q=n(413),x=n(51),F=n(54),U=n(90),D=n.n(U),V=n(420),L=n(201),P=n(302),z=n.n(P),T=n(250),W=n(301),G=Object(c.a)((function(e){return{dialogContent:{padding:0},search:{position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(E.c)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(E.c)(e.palette.common.white,.25)},marginLeft:0,width:"100%"},searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:{padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"}}})),J=function(e){var t=e.user,n=e.sendFriendRequest;return r.a.createElement(j.a,{key:t.email,id:t.id&&t.id},r.a.createElement(N.a,null,r.a.createElement(y.a,{src:t.avatarUrl})),r.a.createElement(v.a,{primary:t.nickname,secondary:t.email}),r.a.createElement(W.a,null,r.a.createElement(L.a,{color:t.blockinguser?x.a[100]:F.a[300],onClick:function(){n(t.userId)},disabled:t.blockinguser},r.a.createElement(z.a,{id:"idAddUserIconButton",color:t.blockinguser?"disabled":"primary"}))))},M=function(e){var t=e.idioma,n=e.buscarUsuarios,a=e.inputSearchRef,i=G(),c=r.a.useState(""),s=Object(o.a)(c,2),l=s[0],u=s[1];return r.a.createElement("div",{className:i.search},r.a.createElement("div",{className:i.searchIcon},r.a.createElement(w.a,null)),r.a.createElement(A.a,{onKeyPress:function(e){13===e.charCode&&n()},placeholder:T.search[t],classes:{root:i.inputRoot,input:i.inputInput},inputProps:{"aria-label":"search"},value:l,onChange:function(e){var t=e.target.value;u(t)},inputRef:a,endAdornment:r.a.createElement(V.a,{position:"end"},""!==l?r.a.createElement(L.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){u("")}},r.a.createElement(D.a,null)):null,r.a.createElement(L.a,{size:"small","aria-label":"toggle password visibility",onClick:n},r.a.createElement(w.a,null)))}))},B=function(e){var t=e.idioma,n=e.closeAddContactWin,a=e.open,o=e.buscarUsuarios,i=e.users,c=e.inputSearchRef,s=e.sendFriendRequest,l=G();return r.a.createElement(C.a,{id:"idWinAddContact",maxWidth:"xs",onEntering:function(){},"aria-labelledby":"confirmation-dialog-title",open:a,onClose:n},r.a.createElement(S.a,{id:"confirmation-dialog-title",className:l.dialogTitle},T.title[t]," "),r.a.createElement(q.a,null),r.a.createElement(M,{idioma:t,buscarUsuarios:o,inputSearchRef:c}),r.a.createElement(R.a,{dividers:!0,className:l.dialogContent},r.a.createElement(O.a,{style:{minHeight:"200px"}},i.map((function(e){return r.a.createElement(J,{user:e,sendFriendRequest:s})})))),r.a.createElement(k.a,null,r.a.createElement(h.a,{autoFocus:!0,onClick:n,color:"primary"},T.close[t])))},H=n(6),_=n(63),K=n(67),Q=n(211),X=n(210),Y=function(e){var t=Object(i.useRecoilValue)(H.j),n=Object(i.useRecoilState)(H.b),c=Object(o.a)(n,2),s=c[0],l=c[1],u=Object(a.useState)([]),d=Object(o.a)(u,2),p=d[0],m=d[1],f=Object(a.useRef)({value:""}),b=Object(i.useRecoilValue)(H.k),g=Object(Q.a)().postRequest,E=Object(i.useRecoilValue)(_.b),h=Object(i.useSetRecoilState)(K.d),O=function(){E?m([{email:"user.email@mail.com",nickname:"Nickname",id:"idUsuarioEjemplo"}]):g({url:"/users/searchContact",bodyParams:{stringPattern:f.current.value,start:0,limit:20},doFnAfterSuccess:function(e){200===e.status&&m(e.data.users)},messageOnError:T.lbErrorLoadingUsers[t]})};Object(a.useEffect)((function(){O()}),[]);return r.a.createElement(B,{idioma:t,closeAddContactWin:function(){l(!1)},open:s,users:p,buscarUsuarios:O,inputSearchRef:f,sendFriendRequest:function(e){g({url:"/users/sendFriendRequest",bodyParams:{userId:e},doFnAfterSuccess:function(t,n){200===t.status&&(m((function(t){return t.filter((function(t){return t.userId!==e}))})),h({action:"add",payload:{friend:t.data.friend}}),X.a.getSocket().emit("request friendship",{userIdRequester:b.userId,userIdRequested:e,token:n}))},messageOnError:T.lbErrorSendigFriendRequest[t]})}})},Z=function(e){return r.a.createElement(Y,null)},$=n(346),ee=r.a.memo((function(e){var t=Object(i.useRecoilState)(H.l),n=Object(o.a)(t,2),a=n[0],c=n[1],s=Object(i.useRecoilState)(H.b),l=Object(o.a)(s,2),u=l[0],d=l[1],p=Object(i.useRecoilValue)(H.j);return r.a.createElement(r.a.Fragment,null,r.a.createElement(g,{open:a,handleOpen:function(){c(!0)},handleClose:function(){c(!1)},idioma:p,text:$,openAddContactView:function(){d(!0)}}),u?r.a.createElement(Z,null):null)}));t.default=function(e){return r.a.createElement(ee,null)}}}]);
//# sourceMappingURL=12.c4f74ce6.chunk.js.map