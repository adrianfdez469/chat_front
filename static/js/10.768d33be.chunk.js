(this.webpackJsonpchat_front=this.webpackJsonpchat_front||[]).push([[10],{210:function(e,t,n){"use strict";var a,o=n(227),c=n.n(o),i=n(216),r={getSocket:function(){return a||(a=c()(i.a.server))},close:function(){a.close()}};t.a=r},211:function(e,t,n){"use strict";var a=n(226),o=n.n(a),c=n(3),i=n(212),r=n(216),s=n(6),u=n(22),d=n(217),l={errConn:{es:"Error de conexi\xf3n",en:"Network error"},getTokenIdError:{es:"Su sesi\xf3n ha expirado",en:"Expired session"}};t.a=function(){var e=Object(i.a)(),t=e.openErrorNotification,n=e.openSuccessNotification,a=Object(c.useRecoilValue)(s.j),f=Object(c.useRecoilValue)(s.f),b=Object(d.a)();return{postRequest:function(e){var c=e.url,i=e.bodyParams,s=void 0===i?{}:i,d=e.doFnAfterSuccess,p=void 0===d?null:d,m=e.doFnAfterError,g=void 0===m?null:m,v=e.messageOnSuccess,O=void 0===v?null:v,h=e.messageOnError,j=void 0===h?null:h,S=function(e){return o.a.post("".concat(r.a.server).concat(c),s,{headers:{Authorization:e}}).then((function(t){return O&&n(O),p&&p(t,e),t})).catch((function(e){return e.response?j&&t(j):t(l.errConn[a]),g&&g(e),e}))};if(f)return S(f).catch((function(e){return console.log("Error al realizar la peticion con el token guardado en recoil state, asi que intentamos usando firebase"),u.a.auth().currentUser.getIdToken(!0).then((function(e){return S(e)})).catch((function(e){return console.log("Error al realizar la peticion con el token proveniente de firebase"),b(),e}))}))}}}},212:function(e,t,n){"use strict";var a=n(9),o=n(20),c=n(3),i=n(72);t.a=function(){var e=Object(c.useRecoilState)(i.a),t=Object(o.a)(e,2),n=t[0],r=t[1],s=Object(a.a)(Object(a.a)({},n),{},{open:!0,autoHideDuration:3e3}),u=function(e,t){r(Object(a.a)(Object(a.a)({},s),{},{severity:e,msg:t}))};return{openNotification:function(e){r(Object(a.a)(Object(a.a)({},s),e))},openSuccessNotification:function(e){u("success",e)},openErrorNotification:function(e){u("error",e)},openInfoNotification:function(e){u("info",e)},openWarningNotification:function(e){u("warning",e)}}}},213:function(e,t,n){"use strict";var a=function(){localStorage.removeItem("denyOSNotification")};t.a={askNotificationPermission:function(e){a();var t=function(t){"permission"in Notification||(Notification.permission=t),e&&e()};"Notification"in window?!function(){try{Notification.requestPermission().then()}catch(e){return!1}return!0}()?Notification.requestPermission((function(e){t(e)})):Notification.requestPermission().then((function(e){t(e)})):console.log("This browser does not support notifications.")},permissionType:function(){return Notification.permission},denyPermission:function(){localStorage.setItem("denyOSNotification",!0)},allowedNotifications:function(){return"granted"===Notification.permission&&!localStorage.getItem("denyOSNotification")}}},214:function(e){e.exports=JSON.parse('{"disconnected":{"es":"se ha desconectado","en":"has disconnected"},"connected":{"es":"se ha conectado","en":"has connected"},"accept":{"es":"es ahora tu contacto","en":"is now your friend"},"decline":{"es":"te ha rechazado","en":"has declined you"},"delete":{"es":"te ha eliminado de sus contactos","en":"has remove you from the list of contacts"},"block":{"es":"te he bloqueado","en":"has bloqued you"},"errorLoadingFriends":{"es":"Error al cargar contactos","en":"Error while loading contacts"},"requestedInv":{"es":"solicita ser su amigo","en":"request be your friend"},"declinedInv":{"es":"ha cancelado la solicitud de amistad","en":"cancel the friend request"},"writingYou":{"es":"ha escrito","en":"has whritten"},"connError":{"es":"Error de conexi\xf3n","en":"Network error"}}')},216:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={server:"https://shut-app-pro.herokuapp.com"}},217:function(e,t,n){"use strict";var a=n(3),o=n(6),c=n(0),i=n(210),r=n(22);t.a=function(){var e=Object(a.useSetRecoilState)(o.k),t=Object(a.useSetRecoilState)(o.m),n=Object(a.useSetRecoilState)(o.c),s=Object(a.useSetRecoilState)(o.h),u=i.a.getSocket(),d=Object(a.useSetRecoilState)(o.n.getAtom);return Object(c.useCallback)((function(){Object(o.e)(),t(null),n([]),s([]),u.emit("logout",{}),i.a.close(),e(null),r.a.auth().signOut(),d(o.n.posibleViews.LOGIN)}),[])}},230:function(e,t){},244:function(e,t,n){"use strict";var a,o,c=n(0),i=n.n(c),r=n(3),s=n(67),u=n(210),d=n(6),l=n(69),f=n(214),b=n(20);"undefined"!==typeof document.hidden?(a="hidden",o="visibilitychange"):"undefined"!==typeof document.msHidden?(a="msHidden",o="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(a="webkitHidden",o="webkitvisibilitychange");var p=function(){var e=Object(c.useState)(!0),t=Object(b.a)(e,2),n=t[0],i=t[1],r=function(){document[a]?i(!1):i(!0)};return Object(c.useEffect)((function(){"undefined"===typeof document.addEventListener||void 0===a?(console.log("Switch to a Google Chrome or Firefox browser, that supports the Page Visibility API."),i(!1)):document.addEventListener(o,r,!1)}),[]),n},m=n(213),g=n(70),v=n.n(g),O=function(e){var t=u.a.getSocket(),n=Object(r.useSetRecoilState)(s.d),a=Object(r.useRecoilValue)(d.k),o=Object(l.b)().enqueueSnackbar,c=p();return{subscribeNewUser:function(){t.on("new user",(function(e){var t={data:e,msg:f.connected};m.a.allowedNotifications()&&!c?t.OSNotification=function(e,t){new Notification(e,{body:t,icon:v.a})}:t.notification=o,n({action:"connect",payload:t})})),a&&t.emit("new user",{userId:a.userId})},unsSubscribeNewUser:function(){t.off("new user")}}},h=function(){var e=Object(r.useSetRecoilState)(s.d),t=u.a.getSocket(),n=Object(l.b)().enqueueSnackbar;return{subscribeDisconnect:function(){t.on("user disconnect",(function(t){e({action:"disconnect",payload:{socketId:t.socketId,notification:n,msg:f.disconnected}})}))},unSubscribeDisconnect:function(){t.off("user disconnect")}}},j=n(9),S=n(212),k=n(211),y=function(e){var t=u.a.getSocket(),n=Object(r.useSetRecoilState)(s.d),a=Object(l.b)().enqueueSnackbar,o=Object(r.useRecoilValue)(d.k),c=Object(r.useRecoilValue)(d.j),i=Object(S.a)().openErrorNotification,b=Object(k.a)().postRequest,g=p();return{subscribeRequestFriend:function(){t.on("requested friendship",(function(e){var t=e.userIdRequester,r=e.userIdRequested,s=e.socketIdRequester;r===o.userId&&b({url:"/users/getFriendById",bodyParams:{friendId:t},doFnAfterSuccess:function(e){if(200===e.status){n({action:"add",payload:{friend:Object(j.a)(Object(j.a)({},e.data.friend),{},{socketId:s})}});var t=e.data.friend;m.a.allowedNotifications()&&!g?new Notification(t.nickname,{body:"".concat(t.nickname," ").concat(f.requestedInv[c]),icon:v.a}):a("".concat(t.nickname," ").concat(f.requestedInv[c]),{variant:"success"})}},doFnAfterError:function(e){e.response?i(f.errorLoadingFriends[c]):i(f.connError[c])}})}))},unSubscribeRequestFriend:function(){t.off("requested friendship")}}},E=function(e){var t=u.a.getSocket(),n=Object(r.useSetRecoilState)(s.d),a=Object(l.b)().enqueueSnackbar,o=Object(r.useRecoilValue)(d.j),c=Object(S.a)().openErrorNotification,i=Object(k.a)().postRequest,b=p();return{subscribeAcceptedFriendship:function(){t.on("accepted friendship",(function(e){var t=e.accepterId,r=e.socketIdAccepter;i({url:"/users/getFriendById",bodyParams:{friendId:t},doFnAfterSuccess:function(e){if(200===e.status){n({action:"update",payload:{friend:Object(j.a)(Object(j.a)({},e.data.friend),{},{socketId:r})}});var t=e.data.friend;m.a.allowedNotifications()&&!b?new Notification(t.nickname,{body:"".concat(t.nickname," ").concat(f.accept[o]),icon:v.a}):a("".concat(t.nickname," ").concat(f.accept[o]),{variant:"success"})}},doFnAfterError:function(e){e.response?c(f.errorLoadingFriends[o]):c(f.connError[o])}})}))},unSubscribeAcceptedFriendship:function(){t.off("accepted friendship")}}},I=function(){var e=u.a.getSocket(),t=Object(r.useSetRecoilState)(s.d),n=Object(l.b)().enqueueSnackbar,a=Object(r.useRecoilValue)(d.j),o=Object(S.a)().openErrorNotification,c=Object(k.a)().postRequest,i=p();return{subscribeDeclinedFriendship:function(){e.on("declined friendship",(function(e){var r=e.declinerId,s=(e.declinedId,e.socketIdDecliner);e.socketIdDeclined;c({url:"/users/getFriendById",bodyParams:{friendId:r},doFnAfterSuccess:function(e){if(200===e.status){t({action:"update",payload:{friend:Object(j.a)(Object(j.a)({},e.data.friend),{},{socketId:s})}});var o=e.data.friend;m.a.allowedNotifications()&&!i?new Notification(o.nickname,{body:"".concat(o.nickname," ").concat(f.declinedInv[a]),icon:v.a}):n("".concat(o.nickname," ").concat(f.declinedInv[a]),{variant:"warning"})}},doFnAfterError:function(e){e.response?404===e.response.status&&t({action:"delete",payload:{friendId:r}}):o(f.connError[a])}})}))},unSubscribeDeclinedFriendship:function(){e.off("declined friendship")}}},R=function(){var e=u.a.getSocket(),t=Object(r.useSetRecoilState)(s.d),n=Object(l.b)().enqueueSnackbar,a=Object(r.useRecoilValue)(d.j),o=Object(S.a)().openErrorNotification,c=Object(k.a)().postRequest,i=p();return{subscribeDeleteContatct:function(){e.on("deleted contact",(function(e){var r=e.deleterId,s=e.socketIdDeleter;c({url:"/users/getFriendById",bodyParams:{friendId:r},doFnAfterSuccess:function(e){if(200===e.status){t({action:"update",payload:{friend:Object(j.a)(Object(j.a)({},e.data.friend),{},{socketId:s})}});var o=e.data.friend;m.a.allowedNotifications()&&!i?new Notification(o.nickname,{body:"".concat(o.nickname," ").concat(f.delete[a]),icon:v.a}):n("".concat(o.nickname," ").concat(f.delete[a]),{variant:"error"})}},doFnAfterError:function(e){e.response?o(f.errorLoadingFriends[a]):o(f.connError[a])}})}))},unSubscribeDeleteContatct:function(){e.off("deleted contact")}}},x=n(71),N=[],w=function(){var e=u.a.getSocket(),t=Object(r.useSetRecoilState)(s.a),n=Object(r.useRecoilValue)(d.k),a=Object(r.useRecoilValue)(d.a),o=Object(l.b)().enqueueSnackbar,g=Object(r.useRecoilState)(s.d),O=Object(b.a)(g,2),h=O[0],j=O[1],S=Object(r.useRecoilValue)(d.j),k=Object(r.useRecoilValue)(d.f),y=p(),E=i.a.useCallback((function(e){N.push(e)}),[]);Object(c.useEffect)((function(){y&&(N.reverse().forEach((function(e){return e()})),N=[])}),[y]),Object(c.useEffect)((function(){return I(),R}),[h,a,y,S]);var I=function(){e.on("recived message",(function(e){var c=e.content,i=e.userOriginId,r=(e.socketIdSender,e.messageId),s=e.datetime;if(h.length>0){var d=h.find((function(e){return e.contactId===i}));if(a!==i){m.a.allowedNotifications()&&!y?new Notification(d.nickname,{body:c,icon:v.a}):o("".concat(d.nickname," ").concat(f.writingYou[S]),{variant:"info"});var l=Object(x.a)({},i,{cantidad:1,lastMessage:c,datetime:s});j({action:"set_message_info",payload:{dataObj:l}})}else{m.a.allowedNotifications()&&!y&&new Notification(d.nickname,{body:c,icon:v.a});var b=Object(x.a)({},i,{cantidad:0,lastMessage:c,datetime:s});j({action:"set_message_info",payload:{dataObj:b}});var p=function(){u.a.getSocket().emit("read messages",{userId:n.userId,contactId:d.contactId,notifyTo:d.socketId,token:k})};y?p():E(p)}t({contactId:i,messageId:r,content:c,datetime:s,state:0})}}))},R=function(){e.off("recived message")};return{subscribeRecibedMessage:I,unSubscribeRecibedMessage:R}},A=function(e){var t=u.a.getSocket(),n=Object(r.useSetRecoilState)(s.c);return{subscribeSavedMessage:function(){t.on("saved message",(function(e){var t=e.contactId,a=e.messageId,o=e.datetime,c=e.consecutive;e.soketIdContact;n({contactId:t,messageId:a,datetime:o,consecutive:c})}))},unSubscribeSavedMessage:function(){t.off("saved message")}}},C=function(e){var t=u.a.getSocket(),n=Object(r.useSetRecoilState)(s.b);return{subscribeReadedMessage:function(){t.on("readed messages",(function(e){var t=e.contactId;n({contactId:t})}))},unSubscribeReadedMessage:function(){t.off("readed messages")}}},F=function(){var e=u.a.getSocket(),t=Object(r.useSetRecoilState)(s.d),n=Object(l.b)().enqueueSnackbar,a=Object(r.useRecoilValue)(d.j),o=Object(S.a)().openErrorNotification,c=Object(k.a)().postRequest,i=p();return{subscribeBlokedContact:function(){e.on("blocked contact",(function(e){var r=e.blokerId,s=e.socketIdBloked;c({url:"/users/getFriendById",bodyParams:{friendId:r},doFnAfterSuccess:function(e){if(200===e.status){t({action:"update",payload:{friend:Object(j.a)(Object(j.a)({},e.data.friend),{},{socketId:s})}});var o=e.data.friend;m.a.allowedNotifications()&&!i?new Notification(o.nickname,{body:"".concat(o.nickname," ").concat(f.block[a]),icon:v.a}):n("".concat(o.nickname," ").concat(f.block[a]),{variant:"error"})}},doFnAfterError:function(e){e.response?o(f.errorLoadingFriends[a]):o(f.connError[a])}})}))},unSubscribeBlokedContact:function(){e.off("bloked contact")}}};t.a=function(e){var t=O(),n=t.subscribeNewUser,a=t.unsSubscribeNewUser,o=h(),c=o.subscribeDisconnect,r=o.unSubscribeDisconnect,s=y(),u=s.subscribeRequestFriend,d=s.unSubscribeRequestFriend,l=E(),f=l.subscribeAcceptedFriendship,b=l.unSubscribeAcceptedFriendship,p=I(),m=p.subscribeDeclinedFriendship,g=p.unSubscribeDeclinedFriendship,v=R(),j=v.subscribeDeleteContatct,S=v.unSubscribeDeleteContatct,k=w(),x=k.subscribeRecibedMessage,N=k.unSubscribeRecibedMessage,M=A(),q=M.subscribeSavedMessage,L=M.unSubscribeSavedMessage,D=C(),V=D.subscribeReadedMessage,B=D.unSubscribeReadedMessage,P=F(),T=P.subscribeBlokedContact,z=P.unSubscribeBlokedContact;return{subscribeAll:i.a.useCallback((function(){n(),c(),u(),f(),m(),j(),x(),q(),V(),T()}),[]),unSubscribeAll:i.a.useCallback((function(){a(),r(),d(),b(),g(),S(),N(),L(),B(),z()}),[])}}},294:function(e,t,n){"use strict";var a=n(1),o=n(4),c=n(0),i=(n(2),n(7)),r=n(8),s=n(13),u=n(165),d=c.forwardRef((function(e,t){var n=e.classes,r=e.className,d=e.color,l=void 0===d?"primary":d,f=e.position,b=void 0===f?"fixed":f,p=Object(o.a)(e,["classes","className","color","position"]);return c.createElement(u.a,Object(a.a)({square:!0,component:"header",elevation:4,className:Object(i.a)(n.root,n["position".concat(Object(s.a)(b))],n["color".concat(Object(s.a)(l))],r,"fixed"===b&&"mui-fixed"),ref:t},p))}));t.a=Object(r.a)((function(e){var t="light"===e.palette.type?e.palette.grey[100]:e.palette.grey[900];return{root:{display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",zIndex:e.zIndex.appBar,flexShrink:0},positionFixed:{position:"fixed",top:0,left:"auto",right:0,"@media print":{position:"absolute"}},positionAbsolute:{position:"absolute",top:0,left:"auto",right:0},positionSticky:{position:"sticky",top:0,left:"auto",right:0},positionStatic:{position:"static"},positionRelative:{position:"relative"},colorDefault:{backgroundColor:t,color:e.palette.getContrastText(t)},colorPrimary:{backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText},colorSecondary:{backgroundColor:e.palette.secondary.main,color:e.palette.secondary.contrastText},colorInherit:{color:"inherit"},colorTransparent:{backgroundColor:"transparent",color:"inherit"}}}),{name:"MuiAppBar"})(d)},295:function(e,t,n){"use strict";var a=n(1),o=n(4),c=n(11),i=n(0),r=(n(2),n(7)),s=n(8),u=i.forwardRef((function(e,t){var n=e.classes,c=e.className,s=e.component,u=void 0===s?"div":s,d=e.disableGutters,l=void 0!==d&&d,f=e.variant,b=void 0===f?"regular":f,p=Object(o.a)(e,["classes","className","component","disableGutters","variant"]);return i.createElement(u,Object(a.a)({className:Object(r.a)(n.root,n[b],c,!l&&n.gutters),ref:t},p))}));t.a=Object(s.a)((function(e){return{root:{position:"relative",display:"flex",alignItems:"center"},gutters:Object(c.a)({paddingLeft:e.spacing(2),paddingRight:e.spacing(2)},e.breakpoints.up("sm"),{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}),regular:e.mixins.toolbar,dense:{minHeight:48}}}),{name:"MuiToolbar"})(u)},357:function(e,t,n){"use strict";var a=n(57);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),c=(0,a(n(68)).default)(o.default.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),"ArrowBack");t.default=c},358:function(e,t,n){"use strict";var a=n(57);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),c=(0,a(n(68)).default)(o.default.createElement("path",{d:"M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z"}),"Cached");t.default=c},359:function(e,t,n){"use strict";var a=n(57);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),c=(0,a(n(68)).default)(o.default.createElement("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"}),"Done");t.default=c},360:function(e,t,n){"use strict";var a=n(57);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),c=(0,a(n(68)).default)(o.default.createElement("path",{d:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"}),"DoneAll");t.default=c},361:function(e){e.exports=JSON.parse('{"errorLoadConversation":{"es":"Error al cargar mensajes","en":"Error loading messages"}}')},362:function(e,t,n){"use strict";var a=n(57);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),c=(0,a(n(68)).default)(o.default.createElement("path",{d:"M9.78 18.65l.28-4.23 7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3 3.64 12c-.88-.25-.89-.86.2-1.3l15.97-6.16c.73-.33 1.43.18 1.15 1.3l-2.72 12.81c-.19.91-.74 1.13-1.5.71L12.6 16.3l-1.99 1.93c-.23.23-.42.42-.83.42z"}),"Telegram");t.default=c},363:function(e){e.exports=JSON.parse('{"notEditable":{"es":"No puede enviar mensajes a este usuario","en":"Can\'t send messages to this user"}}')},426:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(20),i=n(3),r=n(67),s=n(6),u=n(71),d=n(294),l=n(295),f=n(209),b=n(202),p=n(201),m=n(354),g=n(198),v=n(8),O=n(357),h=n.n(O),j=n(280),S=n.n(j),k=Object(g.a)((function(e){var t;return{grow:{flexGrow:1},menuButton:{marginRight:e.spacing(.5)},title:{display:"block",marginLeft:e.spacing(1)},customAppBar:(t={width:"100%"},Object(u.a)(t,e.breakpoints.up("sm"),{width:e.breakpoints.values.sm}),Object(u.a)(t,"right","auto"),t)}})),y=Object(v.a)((function(e){return{badge:{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(m.a),E=Object(v.a)((function(e){return{badge:{backgroundColor:e.palette.grey[500],color:e.palette.grey[500],boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(m.a),I=function(e){return e.contact.socketId&&1===e.contact.friendShipStatus?o.a.createElement(y,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot"},e.children):o.a.createElement(E,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot"},e.children)},R=o.a.memo((function(e){var t=e.closeChat,n=e.contact,a=k(),c=n.avatarUrl?n.avatarUrl:null;return o.a.createElement(d.a,{position:"fixed",className:a.customAppBar},o.a.createElement(l.a,null,o.a.createElement(p.a,{edge:"start",className:a.menuButton,color:"inherit","aria-label":"open drawer",onClick:t},o.a.createElement(h.a,null)),o.a.createElement(I,{contact:n},o.a.createElement(f.a,{src:c})),o.a.createElement(b.a,{className:a.title,variant:"h5",noWrap:!0},n.nickname),o.a.createElement("div",{className:a.grow}),o.a.createElement(p.a,{"aria-label":"show 4 new mails",color:"inherit"},o.a.createElement(S.a,null))))})),x=o.a.memo((function(){var e=Object(i.useRecoilState)(s.a),t=Object(c.a)(e,2),n=t[0],a=t[1],u=Object(i.useRecoilValue)(r.d).find((function(e){return e.contactId===n})),d=o.a.useCallback((function(){a(null)}),[]);return o.a.createElement(R,{closeChat:d,contact:u})})),N=function(e){return o.a.createElement(x,null)},w=n(9),A=n(51),C={50:"#f1f8e9",100:"#dcedc8",200:"#c5e1a5",300:"#aed581",400:"#9ccc65",500:"#8bc34a",600:"#7cb342",700:"#689f38",800:"#558b2f",900:"#33691e",A100:"#ccff90",A200:"#b2ff59",A400:"#76ff03",A700:"#64dd17"},F=n(358),M=n.n(F),q=n(359),L=n.n(q),D=n(360),V=n.n(D),B=n(281),P=n(282),T=Object(g.a)((function(e){return{message:{padding:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px"),maxWidth:"60%",marginTop:e.spacing(2),marginBottom:0,marginLeft:"".concat(e.spacing(2),"px"),marginRight:"".concat(e.spacing(2),"px"),borderRadius:"10px",backgroundColor:e.palette.info.dark,color:e.palette.info.contrastText,position:"relative"},timeMessage:Object(w.a)({paddingLeft:e.spacing(2),maxWidth:"60%",marginBottom:e.spacing(1),marginLeft:"".concat(e.spacing(2),"px"),marginRight:"".concat(e.spacing(1),"px"),color:e.palette.text.disabled},e.typography.subtitle2),mymsg:{textAlign:"right",alignSelf:"flex-end",borderRadius:"10px 0 10px 10px"},notmymsg:{alignSelf:"flex-start",borderRadius:"0 10px 10px 10px"},msgAvatar:{width:e.spacing(3),height:e.spacing(3),position:"absolute",top:"-".concat(e.spacing(1.5),"px")},myMsgAvatar:{right:"-".concat(e.spacing(1.5),"px")},notMyMsgAvatar:{left:"-".concat(e.spacing(1.5),"px")},doneIcon:{marginRight:e.spacing(1),fontSize:e.spacing(2.2)}}})),z=o.a.memo((function(e){var t=e.state,n=e.content,a=e.datetime,c=e.contact,i=e.avatarSrc,r=e.idioma,s=T(),u=t>0?s.mymsg:s.notmymsg,d=t>0?s.myMsgAvatar:s.notMyMsgAvatar,l=t>0?i:c.avatarUrl,b="es"===r?{locale:P.a}:{},p=Object(B.a)(new Date(a),new Date,b),m=null;return 1===t&&(m=o.a.createElement(M.a,{className:s.doneIcon,style:{color:A.a[500]}})),2===t&&(m=o.a.createElement(L.a,{className:s.doneIcon,style:{color:C[500]}})),3===t&&(m=o.a.createElement(V.a,{className:s.doneIcon,style:{color:C[500]}})),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"".concat(s.message," ").concat(u)},o.a.createElement(f.a,{alt:c.nickname,src:l,variant:"circle",className:"".concat(s.msgAvatar," ").concat(d)}),n),o.a.createElement("span",{className:" ".concat(u)},o.a.createElement("span",{className:"".concat(s.timeMessage)},p),m))})),_=Object(g.a)((function(e){return{chatConversation:{position:"relative",flexGrow:1,display:"flex",flexDirection:"column",overflowY:"auto",height:"100%"},offset:e.mixins.toolbar,offsetDown:Object(w.a)(Object(w.a)({},e.mixins.toolbar),{},{bottom:0,position:"relative"})}})),H=function(e){var t=e.contact,n=e.avatarSrc,a=e.messages,c=e.idioma;o.a.useEffect((function(){var e=document.getElementById("chatConversation");e&&(e.scrollTop=e.scrollHeight)}));var i=_();return o.a.createElement("div",{id:"chatConversation",className:i.chatConversation},o.a.createElement("div",{className:i.offset}),a.map((function(e,a,i){return o.a.createElement(z,Object.assign({},e,{key:a,contact:t,avatarSrc:n,idioma:c}))})),o.a.createElement("div",{className:i.offsetDown}))},U=n(211),G=n(361),J=n(244),W=function(){var e=Object(i.useRecoilValue)(s.a),t=Object(i.useSetRecoilState)(r.e),n=Object(i.useRecoilValue)(Object(s.i)(e)),c=Object(i.useRecoilValue)(s.m),u=Object(i.useRecoilValue)(s.j),d=Object(J.a)(),l=d.subscribeAll,f=d.unSubscribeAll,b=Object(i.useRecoilValue)(r.d),p=Object(U.a)().postRequest,m=b.find((function(t){return t.contactId===e}));Object(a.useEffect)((function(){f(),l()}),[]);return Object(a.useEffect)((function(){0===n.length&&p({url:"/messages/getMessagesByContact",messageOnError:G.errorLoadConversation[u],bodyParams:{contactId:m.contactId},doFnAfterSuccess:function(e,n){200===e.status&&t({contactId:m.contactId,conversation:e.data.conversation})}})}),[]),n?o.a.createElement(H,{contact:m,avatarSrc:c,messages:n,idioma:u}):null},Y=function(e){return o.a.createElement(W,null)},$=n(212),K=n(362),Q=n.n(K),X=Object(g.a)((function(e){var t;return{appBar:(t={top:"auto",bottom:0,position:"fixed",width:"100%"},Object(u.a)(t,e.breakpoints.up("sm"),{width:e.breakpoints.values.sm}),Object(u.a)(t,"right","auto"),t),grow:{flexGrow:1},toolbar:{padding:0},icon:{fontSize:e.spacing(3.75)},textarea:{border:"1px solid white",fontFamily:"inherit",fontSize:"large",padding:"1px 6px",backgroundColor:e.palette.background.paper,color:e.palette.text.primary,width:"100%",marginTop:e.spacing(1),marginBottom:e.spacing(1),maxHeight:e.spacing(10),minHeight:e.spacing(4),overflowY:"auto",borderRadius:e.spacing(.5),marginLeft:e.spacing(2),cursor:"text"}}})),Z=function(e){var t=e.sendMessage,n=e.refAreaTexto,a=e.keyPress,c=X();return o.a.createElement(d.a,{color:"primary",className:c.appBar},o.a.createElement(l.a,{variant:"dense",className:c.toolbar},o.a.createElement("div",{className:c.textarea,role:"textbox",contentEditable:!0,ref:n,onKeyPress:a}),o.a.createElement("div",{className:c.grow}),o.a.createElement(p.a,{color:"inherit",onClick:t},o.a.createElement(Q.a,{className:c.icon}))))},ee=n(210),te=n(363),ne=function(e){var t=Object($.a)().openWarningNotification,n=Object(i.useRecoilValue)(s.k),u=Object(i.useRecoilValue)(s.j),d=Object(i.useSetRecoilState)(r.a),l=Object(i.useRecoilValue)(s.a),f=Object(i.useRecoilValue)(s.f),b=Object(i.useRecoilValue)(r.d).find((function(e){return e.contactId===l})),p=Object(a.useRef)(""),m=Object(a.useState)(0),g=Object(c.a)(m,2),v=g[0],O=g[1],h=function(){""!==p.current.innerText.replace(/^(\s*\r*)(.)(\s*\r*)$/,"$2")&&(d({contactId:b.contactId,messageId:v,content:p.current.innerText,datetime:new Date,state:1}),O((function(e){return e+1})),ee.a.getSocket().emit("send message",{content:p.current.innerText,userOriginId:n.userId,userDestinyId:l,toSocketId:b.socketId,token:f,consecutive:v}),p.current.innerText="",p.current.focus())};return Object(a.useEffect)((function(){5!==b.friendShipStatus?p.current.focus():t(te.notEditable[u])}),[]),5!==b.friendShipStatus?o.a.createElement(Z,{sendMessage:h,keyPress:function(e){13===e.charCode&&(e.preventDefault(),h())},refAreaTexto:p}):null},ae=function(e){return o.a.createElement(ne,null)},oe=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(N,null),o.a.createElement(Y,null),o.a.createElement(ae,null))};t.default=function(e){return o.a.createElement(oe,null)}}}]);
//# sourceMappingURL=10.768d33be.chunk.js.map